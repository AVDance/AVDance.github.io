<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/avdance32_32.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/avdance16_16.ico"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"blog.avdancedu.com",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!0,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="作为技术人员，定期写Blog是一个非常好的习惯。你可以通过它将自己的一些学习心得记录下来，也可以对平常的工作做一些经验总结等等。对于我来说，Blog就更为重要了。因为我目前正在创业做一些音视频技术的培训与教学工作，所以特别需要通过Blog将一些音视频知识、课程中的问题解答推广、宣传出去。"><meta property="og:type" content="article"><meta property="og:title" content="hexo博客系统的实现原理与搭建"><meta property="og:url" content="https://blog.avdancedu.com/2020-05-30-hexo%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E4%B8%8E%E6%90%AD%E5%BB%BA/index.html"><meta property="og:site_name" content="音视跳动科技"><meta property="og:description" content="作为技术人员，定期写Blog是一个非常好的习惯。你可以通过它将自己的一些学习心得记录下来，也可以对平常的工作做一些经验总结等等。对于我来说，Blog就更为重要了。因为我目前正在创业做一些音视频技术的培训与教学工作，所以特别需要通过Blog将一些音视频知识、课程中的问题解答推广、宣传出去。"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2020-05-30T05:27:29.000Z"><meta property="article:modified_time" content="2020-06-01T08:39:33.993Z"><meta property="article:author" content="音视跳动"><meta property="article:tag" content="Blog"><meta property="article:tag" content="hexo"><meta property="article:tag" content="next"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://blog.avdancedu.com/2020-05-30-hexo%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E4%B8%8E%E6%90%AD%E5%BB%BA/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>hexo博客系统的实现原理与搭建 | 音视跳动科技</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">音视跳动科技</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">传播最前沿的科技知识！</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/avdance" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.avdancedu.com/2020-05-30-hexo%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E4%B8%8E%E6%90%AD%E5%BB%BA/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://avdancevod.oss-cn-beijing.aliyuncs.com/image/next/avdancelogo.png"><meta itemprop="name" content="音视跳动"><meta itemprop="description" content="传输最前沿的科技知识，学习音视频的圣地！ffmpeg, webrtc, H264, AAC"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="音视跳动科技"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> hexo博客系统的实现原理与搭建</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-05-30 13:27:29" itemprop="dateCreated datePublished" datetime="2020-05-30T13:27:29+08:00">2020-05-30</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-06-01 16:39:33" itemprop="dateModified" datetime="2020-06-01T16:39:33+08:00">2020-06-01</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/hexo/" itemprop="url" rel="index"><span itemprop="name">hexo</span></a></span></span><span id="/2020-05-30-hexo%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E4%B8%8E%E6%90%AD%E5%BB%BA/" class="post-meta-item leancloud_visitors" data-flag-title="hexo博客系统的实现原理与搭建" title="阅读次数"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span class="leancloud-visitors-count"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i></span> <span class="post-meta-item-text">Valine：</span><a title="valine" href="/2020-05-30-hexo%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E4%B8%8E%E6%90%AD%E5%BB%BA/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2020-05-30-hexo%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E4%B8%8E%E6%90%AD%E5%BB%BA/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>3.2k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>3 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>作为技术人员，定期写Blog是一个非常好的习惯。你可以通过它将自己的一些学习心得记录下来，也可以对平常的工作做一些经验总结等等。对于我来说，Blog就更为重要了。因为我目前正在创业做一些音视频技术的培训与教学工作，所以特别需要通过Blog将一些<strong>音视频</strong>知识、课程中的问题解答推广、宣传出去。</p><a id="more"></a><p>以前，我的博客主阵地一直在<strong>简书</strong>，通过简书的Markdown写博客非常方便，而且所见即所得。但最近不知什么原因，简书却将我的Blog给封掉了。我多次申述，但目前简书方面仍然没有任何反馈。考虑到自己在其它平台也可能遇到类似的情况，因此决定还是自己搭建一套博客系统才能真正解决这个问题。</p><p>如何才能快速搭建一套比较专业的博客系统呢？通过调研，我发现hexo完全可以满足我的要求，下面我就来详细讲述一下我是如何通过<strong>hexo</strong>搭建博客系统的吧。</p><h2 id="BLOG系统"><a href="#BLOG系统" class="headerlink" title="BLOG系统"></a>BLOG系统</h2><p>实际上我们仔细想想，所谓的Blog就是将许许多多的通过Markdown语法写成的文档转化成一个个的HTML页面，然后放到Web服务器上发布出来。另一方面，还要有一个系统可以将这些页面管理起来，有目录、有标签，可以分类、搜索等等。</p><p>如果是我们自己实现的话，我们需要实现一个Markdown到HTML的翻译器，然后再实现一个管理系统将这些HTML页面管理起来。而这些工作实际上已经有非常好的开源项目实现了，这就是hexo。hexo 不但实现了这些功能，还有很多其它的功能（如文章浏览次数，创建时间，文章字数等），这些功能对于我们来说都是非常有用的。</p><p>接下来我们就来看看 hexo 是如何实现这些功能的吧。</p><h2 id="hexo实现原理"><a href="#hexo实现原理" class="headerlink" title="hexo实现原理"></a>hexo实现原理</h2><p>我们通常所说的<strong>hexo</strong>是由三部分组成的，即<strong>hexo-cli</strong>、<strong>hexo-core</strong>以及<strong>hexo plugs</strong>。在这三部分中最核心的是 hexo-core 模块，该模块用于将 Markdown 语法编写的文章最终翻译成HTML页面。</p><p>hexo-core在进行翻译时会经历两步:</p><ul><li><p>第一步是将Markdown翻译成下在格式的对JSON对象：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">article: &#123;</span><br><span class="line">    title:</span><br><span class="line">    date:</span><br><span class="line">    tags:</span><br><span class="line">    categories:</span><br><span class="line">    content:</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>第二步才是将上面生成的JSON对象最终生成 HTML 页面。</p></li></ul><p>下面我们来看一下 hexo-core 是如何先将Markdown翻译成JSON的，又是如何将JSON 翻译成HTML的。</p><p>在hexo中，</p><h2 id="如何布署hexo"><a href="#如何布署hexo" class="headerlink" title="如何布署hexo"></a>如何布署hexo</h2><p><strong>hexo</strong>有几个基本信令，分别是<code>hex clean</code>、<code>hexo g</code>、<code>hexo s</code>等等。下面我们分别看一下这几个命信的具体作用是什么：</p><ul><li>hexo clean: 删除 hexo 生成的所有文档，最主要的是public</li><li>hexo g: 根据 source 目录中的文件生成可布署的html</li><li>hexo s: 起动本地http 服务，将生成的 html 在本地发布出来</li><li>hexo d: 将生成的html代码推送到 github 上</li></ul><p>上面命令中的前三个命令让要是用在本地，根据source目录中的源Markdown文件生成 html。而<code>hexo d</code>是布署命令，将最终生成的html布署到服务端。</p><h2 id="next主题的安装与配置"><a href="#next主题的安装与配置" class="headerlink" title="next主题的安装与配置"></a>next主题的安装与配置</h2><p>hexo中有很多的主题，其中用的最多的就是<strong>next</strong>主题。下面我们就来介绍一下如何安装并设置next主题。</p><h2 id="高级知识"><a href="#高级知识" class="headerlink" title="高级知识"></a>高级知识</h2><p>通过上面的操作我们就将自己的blog搭建出来了。但此时这个blog只是一个最一个最基本、最简单的blog。如果你想让你的blog更专业的话，我们还需要装不少的插件，下面我们就来看看有哪些插件是我们必须要装的。它们分别是：</p><ul><li>如何设置摘要</li><li>如何设置图片床</li><li>如何统计阅读次数</li><li>如何显示文章字数</li><li>如何添加评论区</li><li>如何让文章置顶</li><li>如何设置标签</li><li>如何设置标签云</li><li>如何设置本地搜索</li><li>如何设置关于</li><li>设置404</li></ul><p>接下来我们再来详细描述一下上面各功能该如何设置。</p><h3 id="如何设置摘要"><a href="#如何设置摘要" class="headerlink" title="如何设置摘要"></a>如何设置摘要</h3><p>在hexo中实现摘要有两种方法，一种主试是在正文中加入下面这行代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- more --&gt;</span><br></pre></td></tr></table></figure><p>它的作用是将<code>more</code>之前的文字都作为摘要。一般情况下摘要都是在 200 字以内，所以你自己控制放置<code>more</code>的位置就好了。这种方式也是我平常使用的方式，非常方便。</p><p>第二种方法是在文章头的 description 字段中写一段摘要，如下所示：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: xxxx</span><br><span class="line">date: xxxx-xx-xx</span><br><span class="line">...</span><br><span class="line">description: xxxxxxx...</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>这处方式的好处理可以将文中某一段设置为摘要，然后自己单独写一段摘要，这样可以让搜索引擎更容易搜索到。它也是SEO优化的一种方式。</p><p>以上两种方法都可以，可以根据你自己的需求选择合适的方法即可。</p><h3 id="如何设置图片床"><a href="#如何设置图片床" class="headerlink" title="如何设置图片床"></a>如何设置图片床</h3><p>我们的blog最终发布时，一般都是通过github发布出来，但github给我们每个人的资源是有限的，如果你在github上放一些特别大的文件，那么你的网站的访问速度一定很慢，这会延度影响用户的体验。</p><p>另外，不论你将blog放在哪儿发布，你都不应该在发布主站上放置特别大的文件，尤其是大图片。但通常来说，我们写的文章一般又必须放一些图片，这样做一是可以让读者看着更直观，二是可以更吸睛。如何解决上述的矛盾呢？</p><p>解决的办法就是使用<strong>图床</strong>。所谓的图床其实就是云存储，像阿里、腾讯、七牛都提供这种服务，一般来说价格也都不贵。当然了，更好的方式是再通过CDN加速，这样一处非常好的优化网站网速度的方案。</p><p>我这里使用的就是阿里云的OSS，具体的方法我这里就不赘述了，有兴趣的小伙伙伴可以到阿里的官网上自行查阅使用说明。</p><h3 id="如何统计阅读次数"><a href="#如何统计阅读次数" class="headerlink" title="如何统计阅读次数"></a>如何统计阅读次数</h3><p>由于hexo自己没有提供数据库功能，因此hexo中的访问次数统计都是通过第三方云服务来提供支持的。当然你也可以自己做一个云数据库来为hexo提供这个支持。不过大多数情况下大家都是使用的leancloud来实现的。</p><p>我这里也是通过 leancloud 来提供的服务。如果你也想使用leancloud，那你首先需要到leancloud官网上注册一个账户。在leancloud上提供了两种用户类型，一种是developer，一种是商业用户。developer用户是免费的，但leancloud对它的使用有一种限制。不过这对于我们这种访问量很少的blog系统来说已经足够了。</p><p>leancloud的注册步骤我这里就不作介绍了，大家自已按官网的指导进行注册就好了。注册好用户后，我们要创建一个<strong>class</strong>，这里的class类似于我们关系型数据库中的一张表。这个class的名子还是固定的，必须是Counter，只有这样 hexo 才能将数据保存到leancloud上，也才能真正的实现阅读量的统计，</p><h3 id="如何显示文章字数"><a href="#如何显示文章字数" class="headerlink" title="如何显示文章字数"></a>如何显示文章字数</h3><h3 id="如何添加评论区"><a href="#如何添加评论区" class="headerlink" title="如何添加评论区"></a>如何添加评论区</h3><h3 id="如何让文章置顶"><a href="#如何让文章置顶" class="headerlink" title="如何让文章置顶"></a>如何让文章置顶</h3><h3 id="如何开启打赏功能"><a href="#如何开启打赏功能" class="headerlink" title="如何开启打赏功能"></a>如何开启打赏功能</h3><p>hexo 中 next 主题开启打赏功能非常简单，只要稍微配置一下就可以了。在里需要普及一些支付的基本知识，对于正常的支付来说，当用户点击打赏时，可以选择要打赏的金额，之后应该调用腾讯或阿里的支付接口，最终完成支付。但对于hexo来说，显然它做不了这么复杂的交互逻辑，那它是如何做的呢？</p><p>实际上，它只是将微信/支付完的收款二维码放到网页上面来实现打赏功能的。具体的步骤如下：</p><ul><li>生成收款二维码，打开微信/支付宝，将收款二维码保存成图片。</li><li>编辑next主题下面的_config.xmy文件，将该文件中的<code>reward_settings</code>打开即可。具体配置如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Reward (Donate)</span><br><span class="line">reward_settings:</span><br><span class="line">  enable: true</span><br><span class="line">  animation: true</span><br><span class="line">  comment: 只想买包辣条</span><br><span class="line"></span><br><span class="line">reward:</span><br><span class="line">  wechatpay: &#x2F;images&#x2F;wechatpay.png   #微信收款码</span><br><span class="line">  alipay: &#x2F;images&#x2F;alipay.png   #支付宝收款码</span><br><span class="line">  #bitcoin: &#x2F;images&#x2F;bitcoin.png</span><br></pre></td></tr></table></figure> 通过上面的设置，我们就将hexo的打赏功能设置好了。</li></ul><h3 id="如何设置标签"><a href="#如何设置标签" class="headerlink" title="如何设置标签"></a>如何设置标签</h3><h3 id="如何设置标签-如何设置标签云"><a href="#如何设置标签-如何设置标签云" class="headerlink" title="如何设置标签## 如何设置标签云"></a>如何设置标签## 如何设置标签云</h3><h3 id="如何设置本地搜索"><a href="#如何设置本地搜索" class="headerlink" title="如何设置本地搜索"></a>如何设置本地搜索</h3><h3 id="如何设置关于"><a href="#如何设置关于" class="headerlink" title="如何设置关于"></a>如何设置关于</h3><h3 id="设置404"><a href="#设置404" class="headerlink" title="设置404"></a>设置404</h3><h3 id="SEO"><a href="#SEO" class="headerlink" title="SEO"></a>SEO</h3></div><div class="reward-container"><div></div> <button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'> 打赏</button><div id="qr" style="display:none"><div style="display:inline-block"> <img src="https://avdancevod.oss-cn-beijing.aliyuncs.com/image/next/wechat.jpeg" alt="音视跳动 微信支付"><p>微信支付</p></div><div style="display:inline-block"> <img src="https://avdancevod.oss-cn-beijing.aliyuncs.com/image/next/alipay.jpeg" alt="音视跳动 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 音视跳动-李超 [avdance@163.com]</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://blog.avdancedu.com/2020-05-30-hexo%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E4%B8%8E%E6%90%AD%E5%BB%BA/" title="hexo博客系统的实现原理与搭建">https://blog.avdancedu.com/2020-05-30-hexo博客系统的实现原理与搭建/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Blog/" rel="tag"><i class="fa fa-tag"></i> Blog</a><a href="/tags/hexo/" rel="tag"><i class="fa fa-tag"></i> hexo</a><a href="/tags/next/" rel="tag"><i class="fa fa-tag"></i> next</a></div><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"> <a href="/2020-05-31-%E9%9F%B3%E8%A7%86%E9%A2%91%E7%B3%BB%E7%BB%9F%E5%85%A5%E9%97%A8%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/" rel="next" title="音视频系统入门常见问题">音视频系统入门常见问题<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#BLOG系统"><span class="nav-number">1.</span> <span class="nav-text">BLOG系统</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hexo实现原理"><span class="nav-number">2.</span> <span class="nav-text">hexo实现原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如何布署hexo"><span class="nav-number">3.</span> <span class="nav-text">如何布署hexo</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#next主题的安装与配置"><span class="nav-number">4.</span> <span class="nav-text">next主题的安装与配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#高级知识"><span class="nav-number">5.</span> <span class="nav-text">高级知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#如何设置摘要"><span class="nav-number">5.1.</span> <span class="nav-text">如何设置摘要</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何设置图片床"><span class="nav-number">5.2.</span> <span class="nav-text">如何设置图片床</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何统计阅读次数"><span class="nav-number">5.3.</span> <span class="nav-text">如何统计阅读次数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何显示文章字数"><span class="nav-number">5.4.</span> <span class="nav-text">如何显示文章字数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何添加评论区"><span class="nav-number">5.5.</span> <span class="nav-text">如何添加评论区</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何让文章置顶"><span class="nav-number">5.6.</span> <span class="nav-text">如何让文章置顶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何开启打赏功能"><span class="nav-number">5.7.</span> <span class="nav-text">如何开启打赏功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何设置标签"><span class="nav-number">5.8.</span> <span class="nav-text">如何设置标签</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何设置标签-如何设置标签云"><span class="nav-number">5.9.</span> <span class="nav-text">如何设置标签## 如何设置标签云</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何设置本地搜索"><span class="nav-number">5.10.</span> <span class="nav-text">如何设置本地搜索</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何设置关于"><span class="nav-number">5.11.</span> <span class="nav-text">如何设置关于</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#设置404"><span class="nav-number">5.12.</span> <span class="nav-text">设置404</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SEO"><span class="nav-number">5.13.</span> <span class="nav-text">SEO</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="音视跳动" src="https://avdancevod.oss-cn-beijing.aliyuncs.com/image/next/avdancelogo.png"><p class="site-author-name" itemprop="name">音视跳动</p><div class="site-description" itemprop="description">传输最前沿的科技知识，学习音视频的圣地！ffmpeg, webrtc, H264, AAC</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">3</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">2</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">6</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/avdance" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;avdance" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/garrylea/posts" title="ZhiHu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;garrylea&#x2F;posts" rel="noopener" target="_blank"><i class="fa fa-fw fa-zhihu"></i> ZhiHu</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备19056322号-1</a> <img src="http://www.beian.gov.cn/portal/download" style="display:inline-block"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=5580630" rel="noopener" target="_blank">京公网安备5580630号</a></div><div class="copyright"> &copy; <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">李超</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span title="站点总字数">11k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span title="站点阅读时长">10 分钟</span></div><script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              Counter('post', '/classes/Counter', { title, url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"Cu6h7B3RnNt3uEMrRWpVlIU6-gzGzoHsz","app_key":"5dKv9XFD2w3gjJnb0xnWIIWz","server_url":"https://leancloud.cn","security":false};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script></div></footer></div><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("Cu6h7B3RnNt3uEMrRWpVlIU6-gzGzoHsz","5dKv9XFD2w3gjJnb0xnWIIWz")</script><script>function showTime(e){var t=new AV.Query(e),c=[],u=$(".leancloud_visitors");u.each(function(){c.push($(this).attr("id").trim())}),t.containedIn("url",c),t.find().done(function(e){var t=".leancloud-visitors-count";if(0!==e.length){for(var n=0;n<e.length;n++){var o=e[n],i=o.get("url"),s=o.get("time"),r=document.getElementById(i);$(r).find(t).text(s)}for(n=0;n<c.length;n++){i=c[n],r=document.getElementById(i);var l=$(r).find(t);""==l.text()&&l.text(0)}}else u.find(t).text(0)}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(i){var e=$(".leancloud_visitors"),s=e.attr("id").trim(),r=e.attr("data-flag-title").trim(),t=new AV.Query(i);t.equalTo("url",s),t.find({success:function(e){if(0<e.length){var t=e[0];t.fetchWhenSave(!0),t.increment("time"),t.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var n=new i,o=new AV.ACL;o.setPublicReadAccess(!0),o.setPublicWriteAccess(!0),n.setACL(o),n.set("title",r),n.set("url",s),n.set("time",1),n.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):1<$(".post-title-link").length&&showTime(e)})</script><script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdnjs.cloudflare.com/ajax/libs/valine/1.3.10/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'Cu6h7B3RnNt3uEMrRWpVlIU6-gzGzoHsz',
      appKey     : '5dKv9XFD2w3gjJnb0xnWIIWz',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script></body></html>